<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Club VIP</title>
   
  <meta name="facebook-domain-verification" content="qx1zho2wixswe5pr0ill7z3aecxjcp" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Poppins:wght@400;600;700;900&family=Russo+One&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="estilo.css">
  <link rel="icon" type="image/png" href="img/favicon.png">

  <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');

    fbq('init', '1946841772846486'); 
    fbq('track', 'PageView');
  </script>

  <style>
    #logoContainer { visibility: hidden; }
  </style>
</head>

<body style="background-image: url('img/fondotrebol.png'); background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed;">
   
  <h1 class="logo-text" id="logoContainer">
    <span class="logo-emoji" id="brandEmoji">üíé</span>
    <span class="logo-text-fill" id="brandName">CLUB VIP</span>
  </h1>

  <div class="card">
    <div class="main-text">
      <p class="typing">
        <span class="emoji">‚ú®</span>
        EXPERIENCIA PREMIUM 24/7
        <span class="emoji">‚ú®</span>
      </p>

      <p class="dorado-neon">
        ACCESO INMEDIATO
      </p>
    </div>

    <button class="popup-button" id="whatsappButton">
      <span>CRE√Å TU USUARIO</span>
      <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="white" viewBox="0 0 24 24">
        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.149-.67.149-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414-.074-.123-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
      </svg>
    </button>
  </div>

  <div class="info-externa">
    <p id="minimoDeposito"></p>
    <p>EXPERIENCIA PREMIUM ‚Ä¢ ATENCI√ìN 24/7 ‚Ä¢ ACCESO INMEDIATO Y SEGURO</p>
  </div>

  <div class="metodos-pago">
    <h2 class="titulo-pago">M√âTODOS DE PAGO</h2>
    <div class="iconos-pago">
      <img src="img/8043680.png" alt="Transferencia">
      <img src="img/Mercado Pago.png" alt="Mercado Pago">
      <img src="img/logo-large.png" alt="Banco">
      <img src="img/logo-cuenta-dni.png" alt="Cuenta DNI">
    </div>
  </div>

  <script>
    // ==========================================
    // üé≤ 0. ROTADOR DE WHATSAPP
    // ==========================================
    const WHATSAPP_NUMBERS = [
      "5492235575929",
      "5492235575933",
      "5492233408708",
      "5492235307609",
    ];

    function getRandomWhatsApp() {
      const randomIndex = Math.floor(Math.random() * WHATSAPP_NUMBERS.length);
      return WHATSAPP_NUMBERS[randomIndex];
    }

    // ==========================================
    // üé≠ 1. CONFIGURACI√ìN DE MARCAS
    // ==========================================
    const BRANDS = {
      'imperio': { name: 'IMPERIO ESMERALDA', emoji: 'üíé', color: '#00ff88' },
      'rubi': { name: 'IMPERIO RUB√ç', emoji: '‚ù§Ô∏è', color: '#ff3131' },
      'default': { name: 'IMPERIO ESMERALDA', emoji: 'üíé', color: '#00ff88' }
    };

    function applyBranding() {
      const params = new URLSearchParams(window.location.search);
      const brandKey = params.get('marca') || 'default';
      const brand = BRANDS[brandKey] || BRANDS['default'];

      document.getElementById('brandName').textContent = brand.name;
      document.getElementById('brandEmoji').textContent = brand.emoji;
      
      const textElement = document.getElementById('brandName');
      textElement.style.color = brand.color;
      textElement.style.textShadow = `0 0 20px ${brand.color}80`;

      document.getElementById('logoContainer').style.visibility = 'visible';
      document.title = brand.emoji + " " + brand.name;
    }

    applyBranding();

    // ==========================================
    // ‚öôÔ∏è 2. CONEXI√ìN DIRECTA CON EXCEL
    // ==========================================
    
    // üëáüëáüëá ¬°PEGA AQU√ç TU URL DE APPS SCRIPT! üëáüëáüëá
    const SHEET_URL = "https://script.google.com/macros/s/AKfycbyEP1G0v2Rbt-8R_x5h45gLDwyTMXxghPUqZzluBBA1d6BMqVTYPxvD0DCAG768E59L/exec"; 

    let btn;

    // --- Funciones Auxiliares ---
    function getCookie(name) {
      const match = document.cookie.match(new RegExp("(^| )" + name + "=([^;]+)"));
      return match ? match[2] : "";
    }
    function setCookie(name, value) {
      document.cookie = `${name}=${value}; path=/; max-age=63072000`;
    }
    function ensureFBP() {
      let fbp = getCookie("_fbp");
      if (!fbp) {
        fbp = `fb.1.${Date.now()}.${Math.floor(Math.random() * 1e10)}`;
        setCookie("_fbp", fbp);
      }
      return fbp;
    }
    function ensureFBC() {
      const fbclid = new URLSearchParams(window.location.search).get("fbclid");
      if (!fbclid) return "";
      const fbc = `fb.1.${Date.now()}.${fbclid}`;
      setCookie("_fbc", fbc);
      return fbc;
    }
    function generateShortID() {
      const chars = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
      let id = "";
      for (let i = 0; i < 5; i++) id += chars.charAt(Math.floor(Math.random() * chars.length));
      return id;
    }
    function getOrCreateClickID() {
      const stored = localStorage.getItem("click_id");
      if (stored) return stored;
      const id = generateShortID();
      localStorage.setItem("click_id", id);
      return id;
    }

    // --- Env√≠o de Datos al Sheet (Puente Invisible) ---
    function safeSend(payload) {
      if (!SHEET_URL || SHEET_URL.includes("PEGAR_AQUI")) {
        console.warn("‚ö†Ô∏è URL de Sheet no configurada.");
        return;
      }
      try {
        const blob = new Blob([JSON.stringify(payload)], {type : 'text/plain'});
        navigator.sendBeacon(SHEET_URL, blob);
      } catch (e) {
        fetch(SHEET_URL, {
          method: "POST", mode: "no-cors", 
          headers: { "Content-Type": "text/plain;charset=UTF-8" }, 
          body: JSON.stringify(payload)
        });
      }
    }

    // --- Manejo del Clic ---
    async function handleWhatsAppClick(event) {
      event?.preventDefault?.();
      if (btn.disabled) return;
      
      btn.disabled = true;
      btn.querySelector("span").textContent = "CONECTANDO..."; 

      const selectedPhone = getRandomWhatsApp();

      const urlParams = new URLSearchParams(window.location.search);
      const ad_name = urlParams.get('utm_content') || "Organico";
      const campaign_name = urlParams.get('utm_campaign') || "Desconocido";
      const marca = urlParams.get('marca') || "default"; 

      const fbp = ensureFBP();
      const fbc = ensureFBC();
      const click_id = getOrCreateClickID();
      const event_id = "contact-" + click_id;
      const timestamp = new Date().toISOString();

      // Pixel
      if (typeof fbq !== "undefined") {
        fbq("track", "Contact", {}, { eventID: event_id });
      }

      // 1. Enviar datos al Excel (Invisible)
      safeSend({ 
        click_id, fbp, fbc, event_id, timestamp, 
        ad_name, campaign_name, marca, phone: selectedPhone 
      });

      // 2. Abrir WhatsApp (Mensaje Limpio)
      // Como ya guardamos los datos, no hace falta ensuciar el mensaje.
      const message = `Hola! Quiero mi usuario. (ID: ${click_id})`;
      
      setTimeout(() => {
         window.location.href = `https://wa.me/${selectedPhone}?text=${encodeURIComponent(message)}`;
      }, 500); 
    }

    document.addEventListener("DOMContentLoaded", () => {
      btn = document.getElementById("whatsappButton");
      if(btn) btn.addEventListener("click", handleWhatsAppClick);
    });
  </script>
</body>
</html>
